<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>projects – Charles Lehnen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/favicon-32x32.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-TKLYP8KJK7"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-TKLYP8KJK7', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Charles Lehnen</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./aboutme.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./projects.html" aria-current="page"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./photos.html"> 
<span class="menu-text">Photo Gallery</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./documents/Charles Lehnen_CV_2024.pdf"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#project-map" id="toc-project-map" class="nav-link active" data-scroll-target="#project-map">Project Map:</a></li>
  <li><a href="#research-projects" id="toc-research-projects" class="nav-link" data-scroll-target="#research-projects">Research Projects</a></li>
  <li><a href="#science-education-projects" id="toc-science-education-projects" class="nav-link" data-scroll-target="#science-education-projects">Science Education Projects</a></li>
  <li><a href="#github-projects" id="toc-github-projects" class="nav-link" data-scroll-target="#github-projects">Github Projects</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<style>
  /* Default for mobile */
  .responsive-iframe {
    width: 100vw;
    height: 100vw; /* to make it square */
  }

  /* Desktops */
  @media (min-width: 768px) {
    .responsive-iframe {
      width: 50vw;
      height: 28vw; /* to maintain 16:9 aspect ratio */
    }
  }
</style>
<section id="project-map" class="level1">
<h1>Project Map:</h1>
<iframe class="responsive-iframe" src="https://charles-lehnen.shinyapps.io/shiny_map/">
</iframe>
</section>
<section id="research-projects" class="level1">
<h1>Research Projects</h1>
<section id="tortoise-terraforming-will-the-introduction-of-española-galapagos-giant-tortoises-restore-santa-fe-islands-ecosystem" class="level4">
<h4 class="anchored" data-anchor-id="tortoise-terraforming-will-the-introduction-of-española-galapagos-giant-tortoises-restore-santa-fe-islands-ecosystem">Tortoise Terraforming: Will the Introduction of Española Galapagos Giant Tortoises Restore Santa Fe Island’s Ecosystem?</h4>
<p>In collaboration with <a href="https://www.galapagos.org/">Galapagos Conservancy</a> and <a href="https://www.galapagos.org/projects/iniciativa-galapagos/">Iniativa Galápagos</a>, my doctoral research investigates the ecological impacts of introducing Española Giant Tortoises (<em>Chelonoidis hoodensis</em>) to Santa Fe Island, where tortoises have been extinct since the mid-1800s. This project, initiated with a succesful pilot season in the summer of 2023, employs modern ecological techniques including multi-spectral drone imagery, isotope analysis from tortoise keratin, and camera traps to monitor feeding behaviors. The aim is not only to assess the restoration of Santa Fe but also to provide a model for similar conservation efforts globally, offering insights into how other species can be used to revive ecosystems. My work proudly adheres to stringent Galapagos National Park regulations to ensure the protection of wildlife and research integrity.</p>
<ul>
<li><a href="https://eos-gnss.com/successes/galapagos">“Do Giant Tortoises Make Good Neighbors?”</a>.</li>
</ul>
</section>
<section id="distribution-of-arthropod-diversity-in-los-angeles" class="level4">
<h4 class="anchored" data-anchor-id="distribution-of-arthropod-diversity-in-los-angeles">Distribution of Arthropod Diversity in Los Angeles</h4>
<p>In collaboration with the Los Angeles Natural History Museum (NHM) and Cal State, as part of USC’s <a href="https://www.edslab.org/">Ecological Data Science Lab</a> we examined the impact of various factors on arthropod diversity across Los Angeles, analyzing topographical, abiotic, and anthropogenic drivers. We explored the complex responses within and between six arthropod groups, revealing high regional diversity and variable spatial composition. This research underscores the nuanced relationship between urban development and biodiversity, contributing valuable insights for urban ecology and land management practices.</p>
<ul>
<li><a href="https://www.nature.com/articles/s41598-023-50675-3">“Drivers of arthropod biodiversity in an urban ecosystem”</a></li>
<li><a href="https://dornsife.usc.edu/stories/are-bugs-bugging-humans-or-the-other-way-around-study-reveals-surprises/">“Are bugs bugging humans or the other way around? Study reveals surprises”</a></li>
</ul>
</section>
<section id="natural-history-of-galapagos-diptera" class="level4">
<h4 class="anchored" data-anchor-id="natural-history-of-galapagos-diptera">Natural History of Galapagos Diptera</h4>
<p>I led a 4-year natural history study across 5 of the Galapagos islands. This project was a key aspect to the goals of the international Philornis Working Group which focuses on the devastatingly invasive fly <em>Philornis downsi</em>. Understanding the ecology of Galapagos Diptera was essential in estimating impacts of <em>P. downsi</em> control prospects and acquiring endemic, dipteran pupae for non-target biocontrol testing. Prior to my study, the community ecology and rearing substrates of Galapagos Diptera had been virtually unknown. Presently, I am preparing the associated publication as first author.</p>
</section>
<section id="assesing-abandoned-mines-as-a-protected-resource" class="level4">
<h4 class="anchored" data-anchor-id="assesing-abandoned-mines-as-a-protected-resource">Assesing Abandoned Mines as a Protected Resource</h4>
<p>We evaluated the biological relevance of abandoned New Mexican mines as bat roosting, flyover sites, and/or hibernacula. This also included nose swabs for <em>Pseudogymnoascus destructans</em> and guano collection for molecular analysis. Sites were reached through technical 4x4 off-roading, backcountry hiking, and advanced vertical ropework. We used technology including LiDAR, satellite imagery, ArcGIS, GPS, and orienteering to collect precise geospatial data. As an auxiliary aspect, we conducted pre-development avian surveys at mine closure sites utilizing bird identification and nest surveying skills.</p>
<ul>
<li><a href="https://www.esri.com/about/newsroom/arcnews/where-the-bats-go/">“Where the Bats Go”</a>.</li>
<li><a href="https://eos-gnss.com/successes/bat-conservation-international">“Locating Potential Bat Habitats in Abandoned Mines with GIS”</a></li>
</ul>
</section>
<section id="usfws-population-monitoring-of-mojave-desert-tortoises" class="level4">
<h4 class="anchored" data-anchor-id="usfws-population-monitoring-of-mojave-desert-tortoises">USFWS Population Monitoring of Mojave Desert Tortoises</h4>
<p>Along line-distance sampling transects, I collected georeferenced biometric data on IUCN vulnerable Mojave desert tortoise (<em>Gopherus agassizii</em>) populations across Nevada following strict sterile field technique. Metrics included body condition scores, nasal/discharge scores to screen for Mycoplasma infection, and morphological measurements. All protocols were specifically designed to avoid complications including hypothermia, loss of fluids, and transmission of disease/parasites between tortoises.</p>
</section>
<section id="charles-darwin-foundation-geoportal-development" class="level4">
<h4 class="anchored" data-anchor-id="charles-darwin-foundation-geoportal-development">Charles Darwin Foundation GeoPortal Development</h4>
<p>I helped develop a novel <a href="https://geodata.fcdarwin.org.ec/">GeoPortal</a> which distributes Galapagos geographical data to the public and Charles Darwin Foundation (CDF) collaborating scientists. I navigated the CDF’s local, WCS, WFS, WMS distributions as well as their SQL and GeoServer-based databases to gather GIS data. I used QGIS and ArcGIS to analyze this data and then created associated, robust metadata. I helped to improve the GeoPortal’s user interface by building a lightweight, intuitive directory and Wiki using HTML/CSS. The current version of the web application can be viewed at geodata-fcdgps.opendata.arcgis.com/</p>
</section>
<section id="galapagos-national-park-internship" class="level4">
<h4 class="anchored" data-anchor-id="galapagos-national-park-internship">Galapagos National Park Internship</h4>
<p>As a Galapagos National Park intern, I aided in the rearing and husbandry of 180 semi-captive, IUCN endangered <em>Chelonoidis chathamensis</em> tortoises. Tasks consisted of the collection of eggs, monitoring of incubation, care of neonates, preparations of cohort for repatriation, four separate monitoring campaigns, and organization of volunteers. Additionally, I re-invigorated San Cristobal Island’s endemic plant breeding program. Through avid seed and seedling collection, propagation, and nursery care I was able to produce several hundred plants from 20 endemic or native species that were distributed to park and community member land.</p>
</section>
<section id="regulatory-t-cell-research" class="level4">
<h4 class="anchored" data-anchor-id="regulatory-t-cell-research">Regulatory T-cell Research</h4>
<p>Through the University of Minnesota Medical School, I explored the potential of human regulatory T cell-based cellular therapy for Graft-Versus-Host Disease by independently designing and optimizing a novel lentiviral transduction program. The current lab group has continued to build upon my initial protocols. In my role, I also served as the manager of the experimental mouse breeding colony, supervised four interns, and was a co-advisor to two undergraduate directed research projects. My work culminated in a publication in the journal Transplantation as co-author and a research symposium poster at the Masonic Cancer Center Research Symposium.</p>
</section>
<section id="urban-forestry-of-elm-trees" class="level4">
<h4 class="anchored" data-anchor-id="urban-forestry-of-elm-trees">Urban Forestry of Elm Trees</h4>
<p>I aided in the research of Dutch elm disease, nursery techniques, and forestry in harsh, urban field sites. I was trained in plant propagation, agricultural, and pruning techniques in the care of cuttings, seedlings, young trees, as well as nursery stock. I collected seed and took geospatial correlated data at numerous field sites around the state in close collaboration with Saint Paul Parks and Recreation foresters. I personally managed 8 acres of field plots and completed a self-directed research project on <em>Arachis hypogaea</em> growing conditions.</p>
</section>
</section>
<section id="science-education-projects" class="level1">
<h1>Science Education Projects</h1>
<section id="jep-stem-fellowship" class="level4">
<h4 class="anchored" data-anchor-id="jep-stem-fellowship">JEP STEM Fellowship</h4>
<p>Leading the WonderKids virtual afterschool program, I designed and implemented a semester long curriculum that broadens K-5 students’ understanding of STEM, emphasizing diversity in science through guest speaker sessions and virtual tours of scientists’ workspaces. By showcasing scientists from various backgrounds and subfields, the program aims to inspire students to envision themselves in scientific roles while engaging students with hands-on science experiments. My global network enabled me to introduce students to a wide range of scientific careers, reinforcing the program’s commitment to diversity and inclusion in science education.</p>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLU0ue4Xv_K1udN1Nd_DUlmonps7cAh9EG">USC Wonderkids Program Videos</a></li>
</ul>
</section>
<section id="ecology-and-biodiversity-teaching-assistantship" class="level4">
<h4 class="anchored" data-anchor-id="ecology-and-biodiversity-teaching-assistantship">Ecology and Biodiversity Teaching Assistantship</h4>
<p>Contributing to developing USC’s brand new “Ecology and Biodiversity” course for undergraduate juniors and seniors, I collaborated with course lecturers to design a new syllabus and created all lab materials/assignments using R and Quarto. These resources I developed are designed to teach students programming skills for quantitative ecology research, offering them hands-on experience in analyzing ecological data.</p>
<ul>
<li><a href="https://charleslehnen.github.io/BISC_404_Ecology_and_Biodiversity/">Ecology and Biodiversity</a></li>
</ul>
</section>
<section id="anthropology-and-general-biology-teaching-assistantship" class="level4">
<h4 class="anchored" data-anchor-id="anthropology-and-general-biology-teaching-assistantship">Anthropology and General Biology Teaching Assistantship</h4>
<p>Serving as a teaching assistant for the uniquely structured general biology course “The Human Animal,” I prepared lab lectures and organized materials, notably an extensive library of fossil casts. I introduced and developed new lab units, such as a segment on brain anatomy and functional morphology using an Anatomage Table, providing students with a hands-on approach to understanding the complex topics. This course’s unique angle on biology, through the lens of tying back every concept to humans, was particularly engaging for students from across majors taking a general biology course.</p>
</section>
<section id="human-physiology-undergraduate-teaching-assistantship" class="level4">
<h4 class="anchored" data-anchor-id="human-physiology-undergraduate-teaching-assistantship">Human Physiology Undergraduate Teaching Assistantship</h4>
<p>As a teaching assistant, I worked in a team with three professors and fellow TAs to deliver a high quality undergraduate human physiology curriculum. We met one-on-one with weekly to review lesson plans and educational goals. I corrected coursework, answered questions for students, and was in charge of leading lab practicals. Additionally, I self-implemented and guided lecture-style study sessions for students before large exams.</p>
</section>
</section>
<section id="github-projects" class="level1">
<h1><a href="https://github.com/CharlesLehnen">Github Projects</a></h1>
<ul>
<li><p><a href="https://github.com/CharlesLehnen/QGIS_KML_to_DJI_Pilot_2">Program</a> that allows you to make DJI Pilot 2 compatabile drone flight transects in QGIS</p></li>
<li><p><a href="https://github.com/CharlesLehnen/YouTube_Trailcamera_Livestream_Classification_Tool">Machine learning workflow</a> to generate huge datasets of training data from YouTube trail cameras</p></li>
<li><p><a href="https://github.com/EcolDataSciUSC/BioSCAN_2023">Official code and data respository</a> for our 2024 paper <a href="https://www.nature.com/articles/s41598-023-50675-3"><em>Drivers of arthropod biodiversity in an urban ecosystem</em></a></p></li>
<li><p><a href="https://github.com/CharlesLehnen/standard_repository_template">My suggested template</a> for a well organized repo</p></li>
<li><p><a href="https://github.com/CharlesLehnen/portfolio">This website you are on right now</a>, which is edited in Quarto, hosted for free via Github Pages, and rendered to HTML automatically via Github deployment</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.charleslehnen\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><em><a href="https://github.com/CharlesLehnen/portfolio">This website</a> is built with Quarto and hosted on Github Pages. Website design adapted from <a href="https://github.com/alburycatalina/alburycatalina.github.io">Albury Catalina</a>.</em></p>
</div>
  </div>
</footer>




</body></html>